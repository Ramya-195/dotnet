# ... Existing YAML content ...

variables:
  # ... Existing variables ...

  # Agent VM image name
  vmImageName: '<NameOfSelfHostedAgentPool>'  # Use the name of the self-hosted agent pool you created for the self-hosted agent.

stages:
  # ... Existing stages ...

  - stage: Deploy
    displayName: Deploy stage
    dependsOn: Build
    jobs:
    - deployment: Deploy
      condition: and(succeeded(), not(startsWith(variables['Build.SourceBranch'], 'refs/pull/')))
      displayName: Deploy
      pool:
        vmImage: $(vmImageName) # This will use the self-hosted agent for deployment
      environment: 'Ramya195dotnet-1048.mahesh'
      strategy:
        runOnce:
          deploy:
            steps:
            - task: KubernetesManifest@0
              displayName: Create imagePullSecret
              inputs:
                action: createSecret
                secretName: $(imagePullSecret)
                dockerRegistryEndpoint: $(dockerRegistryServiceConnection)

# ... Rest of the YAML content ...